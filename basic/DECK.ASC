10 DEFINT A-Z
20 READ O
30 DIM W(O-1),H(O-1),S(O-1),L(O-1),P(O-1),XO(O-1),YO(O-1):V=&H100
40 FOR I=0 TO O-1
41 READ W(I),H(I),XO(I),YO(I),A$:PRINT "Loading ";A$
42 S(I)=W(I)*H(I)*8:L(I)=V
43 BLOAD A$,&HC000:_MEMCPY(&HC000,V,2*S(I)):V=V+2*S(I)
44 NEXT
50 COLOR 1,15,15:SCREEN 2,2:BLOAD"DECK.SC2",S
60 X1=60:X2=120:Y=40:MB=0:SU=0:I=0:J=0:K=0:R=11:MX=6:LS=0:RS=0
70 DIM SA(3,31)
90 ON STOP GOSUB 3000:STOP ON
130 FOR I=0 TO 31:SA(0,I)=256:SA(1,I)=256:SA(3,I)=10:NEXT
160 _ARTINFO(V,O,MB)
161 _VRMMEM(BASE(12),MB,16*256):_VRMMEM(BASE(11),&H3000,16*256)
162 _MEMVRM(MB,BASE(12)+2048,16*256,0):_MEMVRM(&H3000,BASE(11)+2048,16*256,0)
163 _FILVRM(BASE(12),2048,0,0):_FILVRM(BASE(11),2048,&H1F,0)
170 _MEMCPY(MB,&H3000,16*256)

200 REM LOAD SPRITES AND FORM SPRITE GROUPS, STORE STARTING PATTERN
200 REM ASSUME FIRST <MX> SPRITES FOR LEFT, AND SECOND <MX> SPRITES FOR RIGHT
200 DIM LA(2,MX-1),LB(2,MX-1)
210 DIM RA(2,MX-1),RB(2,MX-1):V=0
220 REM SINCE VARIABLES ARE SEPARATE CODE BLOCK FOR EACH STANCE, FIRST FOR LEFT THEN RIGHT
220 P(0)=V:READ O:FOR I=0 TO O-1:LA(0,I)=I:READ LA(2,I),LA(1,I)
230 A$="":FOR J=0 TO 31:READ K:A$=A$+CHR$(K):NEXT J
240 SPRITE$(V)=A$:V=V+1:NEXT I
250 IF O=MX GOTO 270
260 FOR I=O TO MX-1:LA(0,I)=I:LA(2,I)=256:LA(1,I)=256:NEXT
270 P(1)=V:READ O:FOR I=0 TO O-1:RA(0,I)=I+MX:READ RA(2,I),RA(1,I)
280 A$="":FOR J=0 TO 31:READ K:A$=A$+CHR$(K):NEXT J
290 SPRITE$(V)=A$:V=V+1:NEXT I
300 IF O=MX GOTO 500
310 FOR I=O TO MX-1:RA(0,I)=I:RA(2,I)=256:RA(1,I)=256:NEXT

500 BLOAD"FONT1.BIN",&HC000:_MEMVRM(&HC000,BASE(12)+32*8,768,0)
510 FOR I=34*8 TO 42*8-1:READ O:VPOKE BASE(12)+I,O:NEXT
520 POKE &HFCAF,1:O=BASE(10):_FILVRM(O,256,32,0)
530 POKE &HF922,O MOD 256:POKE &HF3BD,O MOD 256:POKE &HF923,O\256:POKE &HF9BE,O\256:POKE &HF3AF,32:POKE &HF3B0,32:POKE &HF3B1,24
540 LOCATE 0,0:PRINT "  JACK SPARROW  VS ENEMY CAPTAIN"
550 LOCATE 0,2:PRINT CHR$(34);STRING$(30,35);CHR$(36)
560 LOCATE 0,3:PRINT CHR$(37);"        SHIP      JACK SPARROW";CHR$(38)
570 LOCATE 0,4:PRINT CHR$(37);"FORCE: 475 MEN    92 MEN      ";CHR$(38)
580 LOCATE 0,5:PRINT CHR$(37);"MORALE: STRONG    SHAKEN      ";CHR$(38)
590 LOCATE 0,6:PRINT CHR$(39);STRING$(30,40);CHR$(41)

999 _SPRENABLE (SA,SU,0,MX*2):V=1:I=0
1000 REM DRAW LEFT CHARACTER
1000 O=LS*2:_BLIT(X1+XO(O),Y+YO(O),L(O),L(O)+S(O),W(O),H(O),MB,32)
1010 REM DRAW RIGHT CHARACTER
1010 O=RS*2+1:_BLIT(X2+XO(O),Y+YO(O),L(O),L(O)+S(O),W(O),H(O),MB,32)
1020 REM SET PATTERNS 
1020 O=P(LS*2):K=P(RS*2+1)
1030 FOR J=0 TO 5:SA(2,J)=O+J:SA(2,J+MX)=K+J:NEXT
1040 REM MOVE LEFT CHARACTER SPRITE GROUP 
1050 O=LS*2:ON LS+1 GOTO 1060
1060 _SPRGRPMOV(X1+XO(O),Y+YO(O)+64,MX,LA):GOTO 1500

1500 REM MOVE RIGHT CHARACTER SPRITE GROUP 
1500 O=RS*2+1:ON RS+1 GOTO 1510
1510 _SPRGRPMOV(X2+XO(O),Y+YO(O)+64,MX,RA):GOTO 2000

2000 _MEMVRM(MB+(16-R)*256,BASE(12)+(24-R)*256,R*256,2)
2010 _MEMCPY(&H3000,MB,16*256)
2020 X1=(X1+V) MOD (256-W*8):X2=(X2-V) MOD (256-W*8):I=(I+1) MOD 3:IF I=0 THEN V=-V 
2030 A$=INKEY$:IF A$="" GOTO 1000

3000 _SPRDISABLE:COLOR 15,4,4:SCREEN 0

9000 REM META DATA ABOUT SWORD STANCES
9000 REM NUMBER OF STANCES
9000 DATA 4
9010 REM STANCE 1L WIDTH, HEIGHT IN CHARACTERS, X OFFSET, Y OFFSET AND FILE NAME
9010 DATA 10,8,0,24,SWORD1L.BIN
9020 REM STANCE 1R WIDTH, HEIGHT IN CHARACTERS, X OFFSET, Y OFFSET AND FILE NAME
9020 DATA 10,8,0,24,SWORD1R.BIN
9030 REM STANCE 2L WIDTH, HEIGHT IN CHARACTERS, X OFFSET, Y OFFSET AND FILE NAME
9030 DATA 5,11,40,0,SWORD2L.BIN
9040 REM STANCE 2R WIDTH, HEIGHT IN CHARACTERS, X OFFSET, Y OFFSET AND FILE NAME
9040 DATA 5,11,40,0,SWORD2R.BIN

10000 REM SWORD 1L NUMBER OF PATTERNS, (Y,X) OFFSET AND PATTERN DATA
10000 DATA 4,23,0
10010 DATA 0,0,0,0,2,47,93,255,127,62,31,126,56,0,0,0,0,0,0,0,0,0,0,0,128,0,0,0,0,0,0,0
10020 DATA 21,16
10030 DATA 0,224,240,248,120,124,62,31,15,3,0,0,0,0,0,0,64,96,96,48,120,60,0,252,252,252,0,0,0,0,0,0
10040 DATA 10,32
10050 DATA 0,0,8,8,28,28,30,31,63,63,62,60,124,120,240,48,0,0,0,0,0,0,0,128,128,0,0,0,0,0,0,0
10060 DATA 26,32
10070 DATA 0,0,0,0,4,28,62,254,127,63,31,7,7,1,0,0,0,0,0,0,0,0,0,0,0,0,128,128,128,128,0,0

11000 REM SWORD 1R NUMBER OF PATTERNS, OFFSET AND PATTERN DATA
11000 DATA 4,48,0
11010 DATA 0,0,0,0,32,120,93,122,253,30,124,63,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
11020 DATA 45,16
11030 DATA 8,24,24,48,120,240,1,255,255,255,0,0,0,0,0,0,0,28,60,124,120,248,240,192,128,0,0,0,0,0,0,0
11040 DATA 45,32
11050 DATA 0,0,0,0,16,28,62,63,127,126,252,240,240,192,0,0,0,0,0,0,0,0,0,128,0,0,0,0,0,0,0,0
11060 DATA 61,32
11070 DATA 0,0,8,8,28,28,60,252,254,126,62,30,31,15,7,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0

30000 REM WINDOW BORDERS
30000 DATA TOP LEFT
30000 DATA 0,&B01111111,&B01111111,&B01100000,&B01100000,&B01100111,&B01100100,&B01100100
30010 REM TOP LINE
30010 DATA 0,255,255,0,0,255,0,0
30020 REM TOP RIGHT
30020 DATA 0,&B11111110,&B11111110,&B00000110,&B00000110,&B11100110,&B00100110,&B00100110
30030 REM LEFT SIDE
30030 DATA &B01100100,&B01100100,&B01100100,&B01100100,&B01100100,&B01100100,&B01100100,&B01100100
30040 REM RIGHT SIDE
30040 DATA &B00100110,&B00100110,&B00100110,&B00100110,&B00100110,&B00100110,&B00100110,&B00100110
30050 REM BOTTOM LEFT
30050 DATA &B01100100,&B01100100,&B01100111,&B01100000,&B01100000,&B01111111,&B01111111,0
30060 REM BOTTOM LINE
30060 DATA 0,0,255,0,0,255,255,0
30070 REM BOTTOM RIGHT
30070 DATA &B00100110,&B00100110,&B11100110,&B00000110,&B00000110,&B11111110,&B11111110,0