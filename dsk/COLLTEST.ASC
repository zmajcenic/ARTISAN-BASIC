10 REM COLLISION DETECTION TEST
20 COLOR 15,1,4
30 SCREEN 2,2
40 DEFINT A-Z
50 SU=0:A=0:I=0:J=0:X=120:Y=88
60 DIM SA(3,31):DIM RE(7,9):DIM R(5)
70 _FILVRM(BASE(14),32,255,0)
71 A=256*PEEK(5)+PEEK(4)+384
72 FOR I=0 TO 9
73 R(1)=8:R(3)=A+I*8:R(2)=BASE(14)+(I+1)*32
74 _GENCAL(&H5C,R)
75 NEXT I
80 SA(0,0)=Y:SA(1,0)=X:SA(2,0)=0:SA(3,0)=6
81 SA(0,1)=184:SA(1,1)=248:SA(2,1)=63:SA(3,1)=4
82 SA(0,31)=100:SA(1,31)=200:SA(2,31)=0:SA(3,31)=12
90 FOR I=0 TO 9
100 RE(0,I)=1
110 FOR J=1 TO 7:READ RE(J,I):NEXT J
120 IF RE(7,I)=0 THEN LINE(RE(1,I)+RE(3,I),RE(2,I)+RE(4,I))-(RE(1,I)+RE(3,I)+RE(5,I),RE(2,I)+RE(4,I)+RE(6,I)),15,BF
130 NEXT I
140 _SPRENABLE(SA,SU,0,32)
150 FOR I=2 TO 30:SA(0,I)=256:SA(1,I)=256:SA(2,I)=I:SA(3,I)=1:NEXT
160 SU=1

200 IF STRIG(0) THEN _SPRDISABLE:END
210 ON STICK(0)+1 GOTO 200,220,230,240,250,260,270,280,290
220 Y=Y-1:GOTO 300
230 Y=Y-1:X=X+1:GOTO 300
240 X=X+1:GOTO 300
250 Y=Y+1:X=X+1:GOTO 300
260 Y=Y+1:GOTO 300
270 Y=Y+1:X=X-1:GOTO 300
280 X=X-1:GOTO 300
290 Y=Y-1:X=X-1
300 IF X<0 THEN X=0
310 IF X>240 THEN X=240
320 IF Y<0 THEN Y=0
330 IF Y>176 THEN Y=176
340 SA(0,0)=Y:SA(1,0)=X
350 _COLL(A,X,Y,15,15,10,RE)
360 IF A=-1 THEN SA(2,1)=63 ELSE SA(2,1)=A+1
370 SU=1:GOTO 200

1000 DATA 0,0,5,5,5,10,0
1010 DATA 20,20,0,0,8,50,0
1020 DATA 10,180,0,0,200,8,0
1030 DATA 31,0,0,0,15,15,1
1040 DATA 70,70,0,0,25,4,0
1050 DATA 70,80,0,0,5,30,0
1060 DATA 150,150,0,0,30,20,0
1070 DATA 240,10,0,0,10,30,0
1080 DATA 40,120,0,0,40,40,0
1090 DATA 120,120,0,0,4,4,0